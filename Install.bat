@ECHO OFF

:://////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
:://///////////////////////////////////////	 Script to migrate database		/////////////////////////////////////////
:://///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

:: set db name
SET strDBName=Ecommerce
SET strDBServer=C40LAP-10365\SQLEXPRESS
SET LoginUser=sa
SET LoginPass=sa123456

SQLCMD.EXE -S  %strDBServer%  -d  master -U %LoginUser%  -P %LoginPass% -i %cd%\SQL_Scripts\createdb.sql -b >> %cd%\test.log 2>&1 
SQLCMD.EXE -S  %strDBServer%  -d  %strMCDBName% -U %LoginUser%  -P %LoginPass% -i %cd%\SQL_Scripts\createtables.sql -b >> %cd%\test.log 2>&1 

:://////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
:://///////////////////////////////////////	 Script to install this service		/////////////////////////////////////////
:://///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
::set Service Name
SET serviceName=EcommerceAPI

::set Service Executable Path
SET serviceExecutable=EcommerceAPI.exe

SC query "%serviceName%" | find "does not exist" >nul
if %ERRORLEVEL% EQU 0 SC.EXE CREATE "%serviceName%" BINPATH= "%cd%\%serviceExecutable%" start= delayed-auto

SC query "%serviceName%" | find "RUNNING"
IF %ERRORLEVEL% EQU 1 NET START "%serviceName%"